---
title: "HR Data Exploratory Analysis Script"
date: "Summer 2024"
output: html_document
---


# Setup

```{r}
#load needed packages. make sure they are installed.
library(here) #for data loading/saving
library(dplyr)
library(skimr)
library(ggplot2)
```


Load the data.

```{r}
#Path to data. Note the use of the here() package and not absolute paths
data_location = here::here("data","processed-data","HRprocesseddata.rds")
#load data
myhrdata = readRDS(data_location)
```


# HR Data Exploration Through Tables


```{r}
col_names = names(myhrdata)
num_columns = 3  

num_rows = ceiling(length(col_names) / num_columns)

summary_matrix = matrix(col_names, nrow = num_rows, byrow = TRUE)

summary_df = as.data.frame(summary_matrix)


print(summary_df)
#Save to file
summarytable_file = here("results", "tables", "HRvariablestable.rds")
saveRDS(summary_df, file = summarytable_file)

```




```{r}
summary_df = skimr::skim(myhrdata)
print(summary_df)
# save to file
summarytable_file = here("results", "tables", "HRsummarytable.rds")
saveRDS(summary_df, file = summarytable_file)
```


Gender Table

```{r}
#summary_df = skimr::skim(myhrdata)
#print(summary_df)

summary_df = myhrdata %>%
  count(Gender) %>%
  mutate(`Total Count` = n,
         `% of Total` = (n / sum(n)) * 100) %>%
  select(Gender, `Total Count`, `% of Total`)

print(summary_df)
# save to file
summarytable_file = here("results", "tables", "HRgendertable.rds")
saveRDS(summary_df, file = summarytable_file)
```


Tenure Distribution

```{r}
p1 = myhrdata %>%
  ggplot(aes(x = YearsAtCompany)) +
  geom_histogram(binwidth = 1, boundary = 0.5, fill = "gray", color = "black") +
  labs(x = "Tenure", y = "Count") + 
  theme_minimal() +
  theme(panel.background = element_rect(fill = "white"))

print(p1)

figure_file = here("results", "figures","tenure-distribution.png")
ggsave(filename = figure_file, plot=p1)
```



```{r}
p2 = myhrdata %>%
  ggplot(aes(x = TenureCategory)) +
  geom_bar(fill = "gray", color = "black") +
  labs(x = "Tenure", y = "Count", title = "Distribution of Tenure Categories") + 
  theme_minimal() +
  theme(panel.background = element_rect(fill = "white"),
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = FALSE)


print(p2)

figure_file = here("results", "figures","tenure-category.png")
ggsave(filename = figure_file, plot=p2)
```


```{r}
education_levels <- c("Below College", "College", "Bachelor's", "Master's", "Doctorate")

# Convert Education to factor with defined levels
myhrdata$Education <- factor(myhrdata$Education, levels = education_levels)

# Boxplot of MonthlyIncome by Education
p3 <- ggplot(myhrdata, aes(x = Education, y = MonthlyIncome)) +
  geom_boxplot(fill = "gray", color = "black") +
  labs(x = "Education", y = "Monthly Income", title = "Boxplot of Monthly Income by Education") + 
  theme_minimal() +
  theme(panel.background = element_rect(fill = "white"),
        axis.text.x = element_text(angle = 45, hjust = 1))

# Print the plot
print(p3)

figure_file = here("results", "figures","income-education.png")
ggsave(filename = figure_file, plot=p3)
```




